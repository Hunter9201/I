<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>THE LION HUNTER</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="google-site-verification" content="google47c9c1017e180e8f" />
  <meta name="description" content="The Lion Hunter ‚Äì A jungle-themed portal for legal clarity, advocacy training, and nonstop discussion. Built for LDC students, designed for pride." />
  <meta name="keywords" content="The Lion Hunter, Lion Hunter, legal education, LDC Uganda, advocacy, case summaries, jungle platform, Arthur Solutions" />
  <meta property="og:title" content="The Lion Hunter" />
  <meta property="og:description" content="Empowering the pride through immersive learning and nonstop discussion." />
  <meta property="og:image" content="https://i.ibb.co/zVxt3D2Y/LDC-LEGAL-COMPANION.jpg" />
  <link rel="icon" href="https://i.postimg.cc/k4QT4G8c/Lion.jpg?v=1" type="image/jpeg" sizes="any">
  <link rel="shortcut icon" href="https://i.postimg.cc/k4QT4G8c/Lion.jpg?v=1" type="image/jpeg">
  <link rel="apple-touch-icon" href="https://i.postimg.cc/k4QT4G8c/Lion.jpg?v=1">

  <!-- Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-KCLCFN2CV4"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date()); gtag('config', 'G-KCLCFN2CV4');
  </script>
  <!-- Microsoft Clarity -->
  <script>
    (function(c,l,a,r,i,t,y){c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)}
    ;t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i
    ;y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "srhjtupxnp");
  </script>

  <!-- Tailwind (chat only) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;600&display=swap" rel="stylesheet" />

  <style>
    :root{
      --brand:#0f3057;
      --ink:#0f172a;
      --muted:#64748b;
      --line:#e5e7eb;
      --card:#ffffff;
      --brand2:#2e8bc0;
    }

    body { margin:0; font-family:'Poppins',sans-serif; background:#f7f9fc; color:#333; }
    header { position:relative; text-align:center; background:#0b64c0; }

    /* üéûÔ∏è Hero slideshow (all images show in full width) */
    header img#heroImg{
      width:100%;
      height:auto;
      display:block;
      transition:opacity .6s ease-in-out;
      opacity:1;
      background:#0b64c0;
      max-height:70vh;
    }
    .hero-fade-out{ opacity:0; }
    @media (prefers-reduced-motion: reduce){
      header img#heroImg{ transition:none; }
    }

    /* Top alert */
    #calendar-alert {
      background:linear-gradient(to right,#283e51,#4b79a1);
      color:#fff; border-radius:12px; margin:12px auto; width:95%; max-width:1100px;
      padding:12px 16px; font-size:.95rem; font-weight:600;
      box-shadow:0 2px 8px rgba(0,0,0,.15);
      display:flex; align-items:center; justify-content:space-between; gap:10px;
    }
    #calendar-alert a {
      background:#ffeb3b; color:#222; padding:8px 12px; text-decoration:none; border-radius:10px;
      font-weight:800; box-shadow:0 1px 4px rgba(0,0,0,.2);
    }

    /* Hamburger + slide-out nav */
    .menu-icon {
      position:absolute; top:10px; right:20px; font-size:28px; color:#fff;
      background: var(--brand); padding:8px 12px; border-radius:8px; cursor:pointer; z-index:1001;
      box-shadow:0 6px 18px rgba(0,0,0,.18);
    }
    .nav-container {
      position:fixed; top:0; right:-260px; width:260px; height:100%;
      background:#2e8bc0; padding-top:60px; transition:right .3s ease;
      box-shadow:-4px 0 16px rgba(0,0,0,.18); z-index:1000;
    }
    .nav-container.open { right:0; }
    .nav-container a {
      display:block; color:#fff; text-decoration:none; padding:1rem 1.25rem; font-weight:700;
      border-bottom:1px solid rgba(255,255,255,.18);
    }
    .nav-container a:hover { background:#2474a9; }

    /* Login & Timetable */
    .login-hero-btn,
    .timetable-badge{
      background: var(--brand);
      color:#fff; padding:8px 12px; border-radius:999px; font-weight:700; font-size:14px;
      display:inline-flex; gap:8px; align-items:center; box-shadow:0 10px 24px rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.12); text-decoration:none; cursor:pointer; user-select:none;
    }
    .login-hero-btn:hover, .timetable-badge:hover { filter:brightness(1.05); }
    .timetable-dot{ width:8px; height:8px; border-radius:50%; background:#f59e0b; display:inline-block; }

    .login-hero-btn{ position:absolute; top: 16px; left: 16px; z-index:1002; }
    .timetable-wrap{ position:absolute; top: 58px; left: 16px; z-index:1002; font-family: system-ui,-apple-system, Segoe UI, Roboto, Arial, sans-serif; }
    .timetable-pop{
      position:absolute; margin-top:10px; width:300px; background:#ffffff;
      border:1px solid #e5e7eb; border-radius:12px; box-shadow:0 22px 48px rgba(0,0,0,.22);
      padding:10px; display:none;
    }
    .timetable-pop:before{
      content:""; position:absolute; top:-8px; left:22px; width:14px; height:14px;
      background:#fff; border-left:1px solid #e5e7eb; border-top:1px solid #e5e7eb; transform:rotate(45deg);
    }
    .timetable-pop h4{ margin:4px 8px 8px; font-size:14px; font-weight:800; color:#111827; }
    .timetable-list{ max-height:260px; overflow:auto; margin:0; padding:4px; }
    .timetable-item{ display:flex; justify-content:space-between; align-items:center; gap:10px; padding:8px 10px; border-radius:8px; transition:background .15s ease; }
    .timetable-item:hover{ background:#f9fafb; }
    .timetable-item span{ font-size:13px; color:#111827; font-weight:600; }
    .timetable-item a{ font-size:12px; text-decoration:none; padding:6px 10px; border-radius:8px; background:#0ea5e9; color:#fff; font-weight:700; }
    @media (min-width: 481px){
      .login-hero-btn{ top: 24px; left: 24px; }
      .timetable-wrap{ top: 64px; left: 24px; }
    }

    /* Main layout */
    main { padding:24px 16px 8px; text-align:center; max-width:1100px; margin:0 auto; }
    h2 { margin:0 0 12px; color:var(--ink); }
    .sub { color:var(--muted); margin:0 auto 16px; max-width:60ch; }

    /* üîé Search bar */
    .searchbar{
      display:flex; gap:8px; align-items:center; justify-content:center;
      margin:0 0 16px; flex-wrap:wrap;
    }
    .searchbar input{
      width:min(720px, 100%);
      padding:12px 14px; border-radius:12px; border:1px solid var(--line);
      background:#fff; color:#0f172a; font-size:16px; outline:none;
    }
    .search-results{
      margin:8px auto 18px; max-width:1100px; display:grid; gap:10px;
      grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); text-align:left;
    }
    .result-card{
      background:#fff; border:1px solid var(--line); border-radius:12px; padding:12px;
      display:flex; flex-direction:column; gap:8px; box-shadow:0 6px 12px rgba(0,0,0,.04);
    }
    .badge{ display:inline-block; font-size:12px; padding:2px 8px; border-radius:999px; background:#eef6ff; color:#0b64c0; border:1px solid #d8e9ff; }
    .open-btn{ align-self:flex-start; text-decoration:none; background:var(--brand2); color:#fff; border:1px solid #1e5f8a; padding:6px 10px; border-radius:10px; font-weight:800; }

    /* App grid (iPhone-like) */
    .apps {
      display:grid; gap:16px;
      grid-template-columns:repeat(4,1fr);
      padding:8px 0 4px;
    }
    @media (max-width: 900px){ .apps{ grid-template-columns:repeat(3,1fr); } }
    @media (max-width: 600px){ .apps{ grid-template-columns:repeat(3,1fr); gap:14px; } }
    @media (max-width: 420px){ .apps{ grid-template-columns:repeat(3,1fr); gap:12px; } }

    .app { text-decoration:none; display:flex; flex-direction:column; align-items:center; gap:8px; }
    .icon {
      width:84px; height:84px; border-radius:22px;
      display:grid; place-items:center; font-size:34px; color:#fff;
      box-shadow:0 12px 24px rgba(0,0,0,.18), inset 0 0 0 1px rgba(255,255,255,.25);
      transition: transform .12s ease, box-shadow .12s ease;
      background: linear-gradient(160deg,#338eda,#0b64c0);
    }
    @media (max-width:420px){
      .icon{ width:74px; height:74px; font-size:28px; border-radius:20px; }
    }
    .icon.alt1{ background:linear-gradient(160deg,#ef4444,#b91c1c);}
    .icon.alt2{ background:linear-gradient(160deg,#f59e0b,#d97706);}
    .icon.alt3{ background:linear-gradient(160deg,#10b981,#059669);}
    .icon.alt4{ background:linear-gradient(160deg,#8b5cf6,#6d28d9);}
    .icon.alt5{ background:linear-gradient(160deg,#ec4899,#db2777);}
    .icon.alt6{ background:linear-gradient(160deg,#0ea5e9,#0369a1);}
    .icon.alt7{ background:linear-gradient(160deg,#14b8a6,#0d9488);}
    .icon.alt8{ background:linear-gradient(160deg,#eab308,#ca8a04);}
    .icon.alt9{ background:linear-gradient(160deg,#475569,#334155);}
    .icon.alt10{ background:linear-gradient(160deg,#f97316,#ea580c);}
    .icon.alt11{ background:linear-gradient(160deg,#22c55e,#15803d);}
    .icon.alt12{ background:linear-gradient(160deg,#a855f7,#7e22ce);}
    .icon.alt13{ background:linear-gradient(160deg,#60a5fa,#2563eb);}
    .app:active .icon{ transform:scale(.96); box-shadow:0 6px 16px rgba(0,0,0,.18); }
    .label{ font-size:12.5px; line-height:1.1; color:#0f172a; text-align:center; width:92px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; font-weight:700; }
    @media (max-width:420px){ .label{ width:80px; font-size:12px; } }

    /* Calendar widget in grid */
    .widget {
      background:var(--card);
      border:1px solid var(--line);
      border-radius:18px;
      box-shadow:0 10px 22px rgba(0,0,0,.08);
      padding:12px;
      display:flex; flex-direction:column; gap:8px; align-items:stretch; justify-content:space-between;
    }
    .widget.calendar { grid-column: span 2; grid-row: span 2; }
    @media (max-width:400px){
      .widget.calendar{ grid-column: 1 / -1; grid-row:auto; }
    }
    .w-head{ display:flex; align-items:center; justify-content:space-between; gap:8px; }
    .w-title{ font-weight:800; color:var(--ink); font-size:14px; }
    .w-badge{ font-size:12px; background:#eef6ff; color:#0b64c0; padding:4px 8px; border-radius:999px; border:1px solid #d8e9ff; }
    .w-date{ font-size:28px; font-weight:800; color:#0b64c0; letter-spacing:.5px; }
    .w-sub{ font-size:12px; color:var(--muted); margin-top:-2px; }
    .w-events{
      font-size:12.5px; color:var(--ink);
      display:flex; flex-direction:column; gap:6px;
      max-height:160px; overflow:auto; padding-right:4px;
    }
    .ev{ display:flex; align-items:center; gap:8px; }
    .ev-time{ min-width:68px; font-variant-numeric:tabular-nums; color:#0b64c0; font-weight:800; }
    .ev-title{ flex:1; }
    .w-actions{ display:flex; gap:8px; flex-wrap:wrap; margin-top:4px; }
    .btn { display:inline-flex; align-items:center; gap:8px; padding:8px 10px; border-radius:10px; background:var(--brand2); color:#fff; font-weight:800; text-decoration:none; border:1px solid #1e5f8a; font-size:12px; }
    .btn:hover{ filter:brightness(1.05); text-decoration:none; }

    .motto {
      background:#e3eef9; padding:1.25rem; margin:1rem auto 1.25rem; border-radius:12px;
      font-size:1.05rem; font-weight:600; color:#0f3057; max-width:1100px;
    }
    footer { background:#0f3057; color:#ccc; text-align:center; padding:1rem; font-size:.9rem; }

    /* Chat button effects */
    @keyframes lion-dance { 0%,100%{transform:translateY(0) rotate(0) scale(1)} 25%{transform:translateY(-8px) rotate(-3deg) scale(1.05)} 50%{transform:translateY(0) rotate(3deg) scale(1.02)} 75%{transform:translateY(-4px) rotate(2deg) scale(1.04)} }
    @keyframes lion-shake { 0%,100%{transform:translateX(0) rotate(0)} 15%,45%,75%{transform:translateX(-5px) rotate(-3deg)} 30%,60%,90%{transform:translateX(5px) rotate(3deg)} }
    .lion-dancing { animation: lion-dance 1.8s ease-in-out infinite alternate; }
    .lion-stopped { animation:none !important; transform:none !important; }
    .lion-shake { animation: lion-shake .5s ease-in-out 1; }

    /* Mini agenda iframe styling */
    .mini-agenda {
      width:100%;
      height:160px;
      border:0;
      border-radius:8px;
      overflow:hidden;
    }
  </style>
</head>
<body>

  <!-- Alert -->
  <div id="calendar-alert">
    <div>
      üìÖ Check out for a discussion<br><small>Lion Hunt | Nonstop Discussions</small>
    </div>
    <a href="Discussions.html" rel="noopener">View Calendar</a>
  </div>

  <header>
    <div class="menu-icon" onclick="toggleMenu()" aria-label="Toggle menu">‚ò∞</div>
    <!-- üéûÔ∏è Hero slideshow image (all images full width) -->
    <img
      id="heroImg"
      src="https://i.ibb.co/zVxt3D2Y/LDC-LEGAL-COMPANION.jpg"
      alt="LDC LEGAL COMPANION"
      loading="eager"
      decoding="async"
      fetchpriority="high"
    />

    <!-- Login -->
    <a href="login.html" class="login-hero-btn" id="login-hero-btn">Login</a>

    <!-- Timetables -->
    <div class="timetable-wrap" id="timetableWrap" aria-haspopup="true" aria-expanded="false">
      <div class="timetable-badge" id="timetableBtn">
        <span class="timetable-dot"></span>
        Timetables
      </div>
      <div class="timetable-pop" id="timetablePop">
        <h4>Weekly Timetables</h4>
        <div class="timetable-list" id="timetableList"></div>
      </div>
    </div>
  </header>

  <nav id="navMenu" class="nav-container" aria-label="Primary">
    <a href="laws.html">Laws</a>
    <a href="Fullcases.html">All WK Cases</a>
    <a href="caseslandone.html">Case Summaries</a>
    <a href="workshop.html">Workshops</a>
    <a href="Documents.html">Documents</a>
    <a href="IndividualAssessment.html">I.A</a>
    <a href="exams.html">Exams</a>
    <a href="oral-exams.html">Oral Exams</a>
    <a href="category-b.html">Category B</a>
    <a href="trial-advocacy.html">Trial Advocacy</a>
    <a href="audio.html">Audio</a>
    <a href="Discussions.html">Online Discussions</a>
    <a href="services.html">Bar Bites</a>
    <a href="services.html">Legal Services</a>
  </nav>

  <main>
   

    <!-- iPhone-style app icons + Calendar widget inside the grid -->
    <div class="apps" aria-label="App grid">

      <!-- üß© Calendar widget -->
      <div class="widget calendar" aria-label="Calendar widget">
        <div class="w-head">
          <div class="w-title">Today</div>
          <div class="w-badge">Lion Hunt</div>
        </div>
        <div class="w-date" id="miniDate">‚Äî</div>
        <div class="w-sub" id="miniDow">‚Äî</div>

        <!-- Shows today's events: tries API if configured, else uses a tiny day-agenda iframe -->
        <div class="w-events" id="miniEvents">
          <div class="ev"><span class="ev-time">--:--</span><span class="ev-title">Loading today‚Äôs events‚Ä¶</span></div>
        </div>

        <div class="w-actions">
          <a class="btn" href="Discussions.html" rel="noopener">Join next session</a>
        </div>
      </div>

      <!-- Apps -->
      <a class="app" href="laws.html"><div class="icon">üìú</div><span class="label">Laws</span></a>
      <a class="app" href="Fullcases.html"><div class="icon alt1">üìö</div><span class="label">All WK Cases</span></a>
      <a class="app" href="caseslandone.html"><div class="icon alt2">üßæ</div><span class="label">Case Summaries</span></a>
      <a class="app" href="IndividualAssessment.html"><div class="icon alt3">üìù</div><span class="label">I.A</span></a>
      <a class="app" href="workshop.html"><div class="icon alt4">üõ†Ô∏è</div><span class="label">Workshops</span></a>
      <a class="app" href="Documents.html"><div class="icon alt5">üìÑ</div><span class="label">Documents</span></a>
      <a class="app" href="exams.html"><div class="icon alt6">üß™</div><span class="label">Exams</span></a>
      <a class="app" href="oral-exams.html"><div class="icon alt7">üó£Ô∏è</div><span class="label">Oral Exams</span></a>
      <a class="app" href="category-b.html"><div class="icon alt8">üß≠</div><span class="label">Category B</span></a>
      <a class="app" href="trial-advocacy.html"><div class="icon alt9">‚öñÔ∏è</div><span class="label">Trial Advocacy</span></a>
      <a class="app" href="audio.html"><div class="icon alt10">üéß</div><span class="label">Audio</span></a>
      <a class="app" href="services.html"><div class="icon alt11">ü¶Å</div><span class="label">Bar Bites</span></a>
      <a class="app" href="Discussions.html"><div class="icon alt12">üí¨</div><span class="label">Discussions</span></a>
      <a class="app" href="services.html"><div class="icon alt13">üë©‚Äç‚öñÔ∏è</div><span class="label">Legal Services</span></a>
    </div>
  </main>

  <div class="motto">
    <h2>If others can, then with God, I must.<br />This pen is my tool, this paper is my battle ‚Äî and I won‚Äôt stop until the law bows to clarity.</h2>
  </div>

  <footer>
    &copy; 2025 Lion Hunt. Built for the Bar Hunters. Designed for excellence.
  </footer>

  <!-- ü¶Å Floating Chat Button (LEFT) -->
  <button id="lion-chat-button" class="lion-dancing rounded-full fixed bottom-6 left-6 w-14 h-14 bg-yellow-400 shadow-lg text-white text-3xl flex items-center justify-center" title="Chat">
    ü¶Å
  </button>

  <!-- üí¨ Chat Container (LEFT) -->
  <div id="lion-chat-container" class="fixed left-6 bottom-20 flex flex-col bg-white border-2 border-yellow-400 rounded-lg shadow-xl overflow-hidden max-h-0 w-72 transition-[max-height] duration-300">
    <div class="bg-yellow-400 text-white font-bold p-3 text-center">Lion Hunt Bot</div>
    <div id="lion-chat-messages" class="flex flex-col gap-2 p-3 overflow-y-auto" style="max-height: 260px;"></div>
    <div class="flex gap-2 p-3 border-t border-yellow-200">
      <textarea id="lion-user-input" class="flex-1 border rounded-md p-2 text-sm" rows="1" placeholder="Type a message..."></textarea>
      <button id="lion-send-btn" class="px-3 py-2 bg-yellow-400 text-white rounded-md">Send</button>
    </div>
  </div>

  <!-- ConnectyCube widget (optional) -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/connectycube@4/dist/connectycube.min.js"></script>
  <script src="https://unpkg.com/@connectycube/chat-widget@latest/dist/index.umd.js"></script>
  <script>
    (function(){
      const chatWidgetContainer = document.createElement('div');
      chatWidgetContainer.id = 'ConnectyCube_chat-widget';
      document.body.appendChild(chatWidgetContainer);
      const props = {
        appId: 9313,
        authKey: '1C7B8D6C-7CB7-4B0B-9E50-68E6291E3D84',
        userId: '45',
        userName: 'Lion',
        showOnlineUsersTab: false,
        splitView: true,
      };
      if (window.ReactDOM && window.ConnectyCubeChatWidget) {
        ReactDOM.createRoot(chatWidgetContainer)
          .render(React.createElement(ConnectyCubeChatWidget, props));
      }
    })();
  </script>

  <!-- Side menu -->
  <script>
    function toggleMenu(){
      const menu = document.getElementById('navMenu');
      menu.classList.toggle('open');
    }
    document.addEventListener("DOMContentLoaded", () => {
      document.querySelectorAll('#navMenu a').forEach(link => {
        link.addEventListener('click', () => document.getElementById('navMenu').classList.remove('open'));
      });
    });
  </script>

  <!-- Firebase + FCM -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-analytics.js";
    import { getMessaging, getToken, onMessage, isSupported } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-messaging.js";

    const firebaseConfig = {
      apiKey: "AIzaSyABgKrFpiFqC9gndXaK09MvhAVhZHAGk78",
      authDomain: "lionhunterwebpush.firebaseapp.com",
      projectId: "lionhunterwebpush",
      storageBucket: "lionhunterwebpush.firebasestorage.app",
      messagingSenderId: "803161144360",
      appId: "1:803161144360:web:6d64c6c5c275d894a4891d",
      measurementId: "G-GTJFDE1592"
    };

    const app = initializeApp(firebaseConfig);
    try { getAnalytics(app); } catch {}

    if (await isSupported()) {
      const messaging = (await import("https://www.gstatic.com/firebasejs/12.0.0/firebase-messaging.js")).getMessaging(app);

      const swReg = await navigator.serviceWorker.register("/firebase-messaging-sw.js");
      const permission = await Notification.requestPermission();
      if (permission !== "granted") throw new Error("Notification permission not granted.");

      const token = await getToken(messaging, {
        vapidKey: "BOz1LEINl3DEOVWHBBZl4WLVIWR4mONDH0rmovfIvIOauLkE9_uBgN7U94T3rtdaO9AWyaA_WmA7yP1hnEcx98c",
        serviceWorkerRegistration: swReg
      });
      console.log("ü¶Å Device FCM Token:", token);

      onMessage(messaging, (payload) => {
        const n = payload.notification || {};
        alert((n.title||"Lion Hunt") + "\n" + (n.body||""));
      });
    } else {
      console.warn("FCM is not supported in this browser.");
    }
  </script>

  <!-- Simple local chat (OpenAI ‚Äî replace YOUR_OPENAI_API_KEY) -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const btn = document.getElementById('lion-chat-button');
      const container = document.getElementById('lion-chat-container');
      const messagesDiv = document.getElementById('lion-chat-messages');
      const input = document.getElementById('lion-user-input');
      const sendBtn = document.getElementById('lion-send-btn');

      let messages = JSON.parse(localStorage.getItem('lionChat') || '[]');
      const saveHistory = () => localStorage.setItem('lionChat', JSON.stringify(messages));
      const scrollBottom = () => { messagesDiv.scrollTop = messagesDiv.scrollHeight; };

      function appendMsg(content, role) {
        const msg = document.createElement('div');
        msg.className = role === 'user'
          ? 'self-end bg-yellow-400 text-white px-3 py-1 rounded-l-lg rounded-br-lg max-w-[85%] whitespace-pre-wrap'
          : 'self-start bg-gray-100 text-gray-800 px-3 py-1 rounded-r-lg rounded-bl-lg max-w-[85%] whitespace-pre-wrap';
        msg.textContent = content;
        messagesDiv.appendChild(msg);
        scrollBottom();
      }

      messages.forEach(m => appendMsg(m.content, m.role));

      const toggleChat = () => {
        const open = container.classList.toggle('open');
        container.style.maxHeight = open ? '400px' : '0';
        if (!open) { btn.classList.add('lion-dancing'); btn.classList.remove('lion-stopped'); }
        else { input.focus(); }
      };

      btn.addEventListener('click', () => {
        if (btn.classList.contains('lion-dancing')) {
          btn.classList.remove('lion-dancing');
          btn.classList.add('lion-stopped','lion-shake');
          btn.addEventListener('animationend', () => btn.classList.remove('lion-shake'), { once:true });
          container.classList.add('open'); container.style.maxHeight = '400px'; input.focus();
        } else { toggleChat(); }
      });

      sendBtn.addEventListener('click', async () => {
        const text = input.value.trim();
        if (!text) return;
        messages.push({role:'user', content:text}); saveHistory(); appendMsg(text,'user');
        input.value=''; sendBtn.disabled = true;

        const aiBubble = document.createElement('div');
        aiBubble.className = 'self-start bg-gray-100 text-gray-800 px-3 py-1 rounded-r-lg rounded-bl-lg max-w-[85%] whitespace-pre-wrap';
        messagesDiv.appendChild(aiBubble); scrollBottom();

        const atStart = [{role:'system', content:"You are Lion Hunt Bot. If service isn't ready, say: 'Service is not available yet ‚Äî coming soon!'"},
                         ...messages];

        try {
          const resp = await fetch("https://api.openai.com/v1/chat/completions", {
            method:"POST",
            headers:{ "Content-Type":"application/json", "Authorization":"Bearer YOUR_OPENAI_API_KEY" },
            body: JSON.stringify({ model:"gpt-3.5-turbo", messages:atStart, stream:true })
          });
          if (!resp.ok) throw new Error(await resp.text());

          const reader = resp.body.getReader(); const decoder = new TextDecoder("utf-8");
          let assistantText = "";
          while (true) {
            const {value, done} = await reader.read(); if (done) break;
            const chunk = decoder.decode(value, {stream:true});
            chunk.split("\n").forEach(line => {
              if (line.startsWith("data: ")) {
                const json = line.slice(6).trim();
                if (json === "[DONE]") return;
                try {
                  const parsed = JSON.parse(json);
                  const delta = parsed.choices[0].delta?.content;
                  if (delta) { assistantText += delta; aiBubble.textContent = assistantText; scrollBottom(); }
                } catch {}
              }
            });
          }
          messages.push({role:'assistant', content:assistantText}); saveHistory();
        } catch(err) {
          aiBubble.textContent = "Error: " + err;
        } finally { sendBtn.disabled = false; }
      });

      input.addEventListener('keydown', e => {
        if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); sendBtn.click(); }
      });
    });
  </script>

  <!-- Timetable logic + mini date fill -->
  <script>
    const WEEK_LINKS = [
      { label: "Week 1 (Family)",    url: "https://drive.google.com/drive/folders/1p4CqiLEgrcY0m-yCBDDB0zbLBQh5nZia?usp=sharing" },
      { label: "Week 2 (Civil)",     url: "https://drive.google.com/drive/folders/1KZAbnXqZKGKcyNow_tLrS0bSwDYPrH3l?usp=sharing" },
      { label: "Week 3 (Corporate)", url: "https://drive.google.com/file/d/EXAMPLE3/preview" },
      { label: "Week 4 (Criminal)",  url: "https://docs.google.com/document/d/EXAMPLE4/preview" },
      { label: "Week 5 (Land)",      url: "https://docs.google.com/document/d/EXAMPLE5/preview" }
    ];
    const listEl = document.getElementById('timetableList');
    if (listEl) {
      WEEK_LINKS.forEach(item => {
        const row = document.createElement('div');
        row.className = 'timetable-item';
        const title = document.createElement('span'); title.textContent = item.label;
        const open = document.createElement('a'); open.textContent = 'Open'; open.href = item.url; open.target = '_blank'; open.rel = 'noopener';
        row.appendChild(title); row.appendChild(open); listEl.appendChild(row);
      });
    }
    const btn  = document.getElementById('timetableBtn');
    const pop  = document.getElementById('timetablePop');
    const wrap = document.getElementById('timetableWrap');
    function openPop(){ pop.style.display = 'block'; wrap.setAttribute('aria-expanded','true');
      document.addEventListener('click', onClickAway, {capture:true}); document.addEventListener('keydown', onEsc); }
    function closePop(){ pop.style.display = 'none'; wrap.setAttribute('aria-expanded','false');
      document.removeEventListener('click', onClickAway, {capture:true}); document.removeEventListener('keydown', onEsc); }
    function onClickAway(e){ if(!wrap.contains(e.target)) closePop(); }
    function onEsc(e){ if(e.key==='Escape') closePop(); }
    if (btn) { btn.addEventListener('click', e=>{ e.stopPropagation(); (pop.style.display==='block') ? closePop() : openPop(); }); }

    // Lock login temporarily
    document.addEventListener('DOMContentLoaded', () => {
      const loginBtn = document.getElementById('login-hero-btn');
      loginBtn?.addEventListener('click', (e) => { e.preventDefault(); alert("üîí Premium services coming soon!"); });
    });

    // üóìÔ∏è Fill the mini widget date (Today)
    (function(){
      const d = new Date();
      const months = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
      const days = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
      document.getElementById('miniDate').textContent = `${months[d.getMonth()]} ${d.getDate()}, ${d.getFullYear()}`;
      document.getElementById('miniDow').textContent  = days[d.getDay()];
    })();
  </script>

  <!-- üéûÔ∏è Hero slideshow (5s interval, all images full width) -->
  <script>
    const HERO_IMAGES = [
      { src: "https://i.ibb.co/zVxt3D2Y/LDC-LEGAL-COMPANION.jpg", alt: "LDC LEGAL COMPANION" },   // starts first
      { src: "https://i.postimg.cc/28k9C3Nw/younglawyer.png",      alt: "Young Lawyer" },
      { src: "https://i.postimg.cc/xdQqJrj9/books.jpg",            alt: "Law books" },
      { src: "https://i.postimg.cc/bJCvBsxv/lib.jpg",              alt: "Library shelves" }
    ];

    (function setupHeroSlideshow(){
      const img = document.getElementById("heroImg");
      if(!img) return;

      // Preload
      HERO_IMAGES.forEach(i => { const p = new Image(); p.src = i.src; });

      let i = 0;
      const DURATION = 5000; // 5 seconds
      let timerId;

      function swap() {
        i = (i + 1) % HERO_IMAGES.length;
        img.classList.add("hero-fade-out");
        const next = HERO_IMAGES[i];

        const onLoad = () => {
          img.removeEventListener("load", onLoad);
          requestAnimationFrame(() => img.classList.remove("hero-fade-out"));
        };

        img.addEventListener("load", onLoad);
        img.alt = next.alt || "";
        img.src = next.src;
      }

      function start(){ if(!timerId) timerId = setInterval(swap, DURATION); }
      function stop(){ clearInterval(timerId); timerId = null; }

      document.addEventListener("visibilitychange", () =>
        document.hidden ? stop() : start()
      );

      if (window.matchMedia && window.matchMedia("(prefers-reduced-motion: reduce)").matches) {
        return; // keep the first image, no animation
      }
      start();
    })();
  </script>

  <!-- üîé Client-side search logic (auto-search, no button) -->
  <script>
    const INDEX = [
      // Statutes / Acts
      { title: "Evidence Act (Uganda)", type: "Statute", tags: "evidence statute burden proof hearsay", url: "laws.html" },
      { title: "Civil Procedure Act", type: "Statute", tags: "civil procedure pleadings service jurisdiction", url: "laws.html" },
      { title: "Criminal Procedure Code", type: "Statute", tags: "criminal procedure arrest bail trial", url: "laws.html" },
      { title: "Land Act", type: "Statute", tags: "land tenure registration mortgages conveyancing", url: "laws.html" },

      // Cases
      { title: "Donoghue v Stevenson [1932] AC 562", type: "Case", tags: "negligence duty of care snail bottle tort", url: "Fullcases.html" },
      { title: "Carlill v Carbolic Smoke Ball Co [1893] 1 QB 256", type: "Case", tags: "contract offer acceptance unilateral advertisement reward", url: "Fullcases.html" },
      { title: "Rylands v Fletcher (1868)", type: "Case", tags: "tort strict liability escape non-natural use", url: "Fullcases.html" },

      // Collections
      { title: "All Workshop Cases", type: "Collection", tags: "cases list workshop full text", url: "Fullcases.html" },
      { title: "Case Summaries", type: "Collection", tags: "summaries briefs digests workshop", url: "caseslandone.html" }
    ];

    const q   = document.getElementById('q');
    const out = document.getElementById('searchResults');

    function renderResults(items, term){
      if(!term){ out.innerHTML=''; return; }
      if(!items.length){
        out.innerHTML = `
          <div class="result-card">
            <strong>No matches for ‚Äú${term}‚Äù.</strong>
            <div>Try keywords like <em>negligence</em>, <em>evidence</em>, <em>land</em>, or open a library:</div>
            <div style="display:flex; gap:8px; margin-top:8px; flex-wrap:wrap;">
              <a class="open-btn" href="laws.html">Open Laws</a>
              <a class="open-btn" href="Fullcases.html">Open All Cases</a>
              <a class="open-btn" href="caseslandone.html">Open Summaries</a>
            </div>
          </div>`;
        return;
      }
      out.innerHTML = items.map(item => `
        <div class="result-card">
          <div style="display:flex; align-items:center; justify-content:space-between; gap:8px;">
            <strong>${item.title}</strong>
            <span class="badge">${item.type}</span>
          </div>
          <a class="open-btn" href="${item.url}">Open</a>
        </div>
      `).join('');
    }

    function doSearch(){
      const term = (q.value || '').trim().toLowerCase();
      if(!term){ out.innerHTML=''; return; }
      const words = term.split(/\s+/).filter(Boolean);
      const items = INDEX.filter(it => {
        const hay = (it.title + ' ' + it.tags).toLowerCase();
        return words.every(w => hay.includes(w));
      }).slice(0, 24);
      renderResults(items, term);
    }

    // Auto-search as you type (debounced) + Enter key
    let debounceTimer;
    q.addEventListener('input', () => {
      clearTimeout(debounceTimer);
      debounceTimer = setTimeout(doSearch, 200);
    });
    q.addEventListener('keydown', (e)=>{ if(e.key==='Enter') doSearch(); });
  </script>

  <!-- üìÖ Mini calendar: show today's events (API if set; else embed today-only day agenda) -->
  <script>
    (async function loadTodaysEvents(){
      // OPTIONAL: if you add a Google API key and make the calendar public, this list view will be used
      const API_KEY = ""; // e.g. "AIza..."; leave blank to use the embed fallback
      const CAL_ID  = "lionhunter920@gmail.com";
      const TIMEZONE = "Africa/Nairobi";

      const eventsBox = document.getElementById('miniEvents');

      function setStatus(text){
        eventsBox.innerHTML = `<div class="ev"><span class="ev-time">‚Äî</span><span class="ev-title">${text}</span></div>`;
      }

      function fmtTime(dtOrDate){
        if (dtOrDate.date) return "All day";
        const dt = new Date(dtOrDate.dateTime || dtOrDate);
        let h = dt.getHours(), m = dt.getMinutes();
        const ampm = h >= 12 ? "PM" : "AM";
        h = h % 12 || 12;
        const mm = m.toString().padStart(2, "0");
        return `${h}:${mm} ${ampm}`;
      }

      if (API_KEY && !API_KEY.startsWith("YOUR_")) {
        try{
          const now = new Date();
          const partsToday = new Intl.DateTimeFormat('en-CA',{ timeZone: TIMEZONE, year:'numeric', month:'2-digit', day:'2-digit'}).format(now).split('-');
          const y = +partsToday[0], m = +partsToday[1], d = +partsToday[2];
          const start = new Date(Date.UTC(y, m-1, d, 0, 0, 0));
          const end   = new Date(Date.UTC(y, m-1, d+1, 0, 0, 0));

          const params = new URLSearchParams({
            key: API_KEY,
            singleEvents: "true",
            orderBy: "startTime",
            timeMin: start.toISOString(),
            timeMax: end.toISOString(),
            timeZone: TIMEZONE,
            showDeleted: "false",
            maxResults: "10"
          });

          const url = `https://www.googleapis.com/calendar/v3/calendars/${encodeURIComponent(CAL_ID)}/events?${params.toString()}`;
          const resp = await fetch(url);
          if(!resp.ok) throw new Error(await resp.text());
          const data = await resp.json();
          const events = (data.items || []).filter(e => e.status !== "cancelled");

          if (!events.length){
            setStatus("No events scheduled today.");
            return;
          }

          const html = events.slice(0,6).map(e => {
            const s = e.start || {}, ed = e.end || {};
            const when  = s.date ? "All day" : `${fmtTime(s)}‚Äì${fmtTime(ed)}`;
            const title = e.summary || "(No title)";
            return `<div class="ev"><span class="ev-time">${when}</span><span class="ev-title">${title}</span></div>`;
          }).join("");

          eventsBox.innerHTML = html;
          return;
        }catch(err){
          console.warn("Falling back to embed:", err);
        }
      }

      // üîÅ Fallback: small embedded DAY agenda locked to today's date in Africa/Nairobi
      function ymdInTZ(tz, date){
        const parts = new Intl.DateTimeFormat('en-CA',{ timeZone: tz, year:'numeric', month:'2-digit', day:'2-digit'}).formatToParts(date);
        const get = t => parts.find(p => p.type === t).value;
        return { y: +get('year'), m: +get('month'), d: +get('day') };
      }
      function addDaysUTC(y,m,d,days){
        const dt = new Date(Date.UTC(y, m-1, d));
        dt.setUTCDate(dt.getUTCDate()+days);
        return { y: dt.getUTCFullYear(), m: dt.getUTCMonth()+1, d: dt.getUTCDate() };
      }
      function yyyymmdd(obj){
        const mm = String(obj.m).padStart(2,'0');
        const dd = String(obj.d).padStart(2,'0');
        return `${obj.y}${mm}${dd}`;
      }

      const todayParts = ymdInTZ(TIMEZONE, new Date());
      const tomorrow   = addDaysUTC(todayParts.y, todayParts.m, todayParts.d, 1);
      const startStr   = yyyymmdd(todayParts);
      const endStr     = yyyymmdd(tomorrow);

      const embedParams = new URLSearchParams({
        src: CAL_ID,
        ctz: TIMEZONE,
        mode: "AGENDA",
        dates: `${startStr}/${endStr}`,
        showTitle: "0",
        showNav: "0",
        showDate: "0",
        showPrint: "0",
        showTabs: "0",
        showCalendars: "0",
        showTz: "0",
        wkst: "1",
        bgcolor: "#ffffff"
      });

      const iframe = document.createElement('iframe');
      iframe.className = 'mini-agenda';
      iframe.loading = 'lazy';
      iframe.title = 'Today‚Äôs agenda';
      iframe.referrerPolicy = 'no-referrer-when-downgrade';
      iframe.src = `https://calendar.google.com/calendar/embed?${embedParams.toString()}`;

      eventsBox.replaceWith(iframe);
    })();
  </script>
</body>
</html>
